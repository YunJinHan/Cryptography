/*  ======================================================================== *

                                    주 의 사 항


    1. 계산 중간 흐름은 다음 문서를 보고 비교하는 것을 추천함

		http://grouper.ieee.org/groups/1619/email/pdf00046.pdf

 *  ======================================================================== */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "XTS_AES.h"

typedef unsigned char BYTE;

uint8_t iv[]  = { 
	// 직접 작성해서 테스트
	0xff, 0xfe, 0xfd, 0xfc, 0xfb, 0xfa, 0xf9, 0xf8, 0xf7, 0xf6, 0xf5, 0xf4, 0xf3, 0xf2, 0xf1, 0xf0
};

uint8_t key[] = { 
	// 직접 작성해서 테스트
	0xd5, 0x0d, 0xc2, 0xe9, 0x31, 0x3b, 0xf1, 0xb9, 0x3b, 0x4e, 0x7c, 0x58, 0x0e, 0xb5, 0x09, 0x3e,
    0xbf, 0xbe, 0xbd, 0xbc, 0xbb, 0xba, 0xb9, 0xb8, 0xb7, 0xb6, 0xb5, 0xb4, 0xb3, 0xb2, 0xb1, 0xb0
};

uint8_t plain1[] = { 
	// 직접 작성해서 테스트
	0xff, 0xfe, 0xfd, 0xfc, 0xfb, 0xfa, 0xf9, 0xf8, 0xf7, 0xf6, 0xf5, 0xf4, 0xf3, 0xf2, 0xf1, 0xf0,
    0xbf, 0xbe, 0xbd, 0xbc, 0xbb, 0xba, 0xb9, 0xb8, 0xb7, 0xb6, 0xb5, 0xb4, 0xb7, 0xb6, 0xb5, 0xb4,
    0xd5, 0x0d, 0xc2, 0xe9, 0x31, 0x3b, 0xf1, 0xb9, 0x3b, 0x4e, 0x7c, 0x58, 0x0e, 0xb5, 0x09, 0x3e,
    0xbf, 0xbe, 0xbd, 0xbc, 0xbb, 0xba, 0xb9, 0xb8, 0xb7, 0xb6, 0xb5, 0xb4, 0xb3, 0xb2, 0xb1, 0xb0
};

uint8_t cipher1[] = { 
	// 직접 작성해서 테스트
	0xcd, 0x51, 0x16, 0x14, 0xa9, 0x20, 0x8c, 0x2d, 0x44, 0x05, 0xda, 0x97, 0x09, 0xd9, 0xa2, 0x1d, 
	0xe9, 0x1b, 0xd5, 0x7f, 0x9d, 0x7c, 0xc2, 0xfa, 0x0b, 0xdb, 0x68, 0x18, 0x51, 0xd8, 0xe8, 0xdf, 
	0x30, 0x7e, 0x00, 0x58, 0xb5, 0xc9, 0x40, 0x0e, 0xdc, 0xd4, 0x68, 0x1b, 0xca, 0x91, 0x13, 0x59, 
	0x56, 0xd1, 0x11, 0x72, 0xf1, 0x66, 0x08, 0xe9, 0x69, 0x53, 0x4b, 0x02, 0x4d, 0x73, 0x32, 0x02
};

uint8_t plain2[] = { 
	// 직접 작성해서 테스트
	0xff, 0xfe, 0xfd, 0xfc, 0xfb, 0xfa, 0xf9, 0xf8, 0xf7, 0xf6, 0xf5, 0xf4, 0xf3, 0xf2, 0xf1, 0xf0,
    0xbf, 0xbe, 0xbd, 0xbc, 0xbb, 0xba, 0xb9, 0xb8, 0xb7, 0xb6, 0xb5, 0xb4, 0xb7, 0xb6, 0xb5, 0xb4,
    0xd5, 0x0d, 0xc2, 0xe9, 0x31
};

uint8_t cipher2[] = { 
	// 직접 작성해서 테스트
	0xcd, 0x51, 0x16, 0x14, 0xa9, 0x20, 0x8c, 0x2d, 0x44, 0x05, 0xda, 0x97, 0x09, 0xd9, 0xa2, 0x1d, 
	0x75, 0x6a, 0x7b, 0xef, 0x1e, 0x58, 0x78, 0x50, 0x13, 0xd5, 0xf5, 0x1f, 0x46, 0x13, 0x4e, 0xe1, 
	0xe9, 0x1b, 0xd5, 0x7f, 0x9d
};

uint8_t plain3[] = { 
	// 직접 작성해서 테스트
	0x58, 0x78, 0x50, 0x13, 0xd5, 0xf5, 0x1f, 0x46, 0x13, 0x4e, 0xe1, 0x75, 0x6a, 0x7b, 0xef, 0x1e,
	0xff
};

uint8_t cipher3[] = { 
	// 직접 작성해서 테스트
	0xad, 0x42, 0x1f, 0xe2, 0x24, 0x82, 0x7b, 0x7b, 0x18, 0x90, 0x14, 0x79, 0x2b, 0xba, 0x4e, 0x42, 
	0x9d
};


int main(void){
	BYTE tmp[64];
	BYTE tmp2[64];
	BYTE tmp3[64];

	// 암호화 테스트
	XTS_AES128(plain1, tmp, 64, key, ENC);
	printf("XTS_AES Encryption: %s\n", 0 == strncmp((char*) cipher1, (char*) tmp, 64) ? "SUCCESS!" : "FAILURE!");

	// 복호화 테스트
	XTS_AES128(tmp, cipher1, 64, key, DEC);
	printf("XTS_AES Decryption: %s\n", 0 == strncmp((char*) tmp, (char*) plain1, 64) ? "SUCCESS!" : "FAILURE!");

	// 암호화 테스트
	XTS_AES128(plain2, tmp2, 37, key, ENC);
	printf("XTS_AES Encryption: %s\n", 0 == strncmp((char*) cipher2, (char*) tmp2, 37) ? "SUCCESS!" : "FAILURE!");

	// 복호화 테스트
	XTS_AES128(tmp2, cipher2, 37, key, DEC);
	printf("XTS_AES Decryption: %s\n", 0 == strncmp((char*) tmp2, (char*) plain2, 37) ? "SUCCESS!" : "FAILURE!");

	// 암호화 테스트
	XTS_AES128(plain3, tmp3, 17, key, ENC);
	printf("XTS_AES Encryption: %s\n", 0 == strncmp((char*) cipher3, (char*) tmp3, 17) ? "SUCCESS!" : "FAILURE!");

	// 복호화 테스트
	XTS_AES128(tmp3, cipher3, 17, key, DEC);
	printf("XTS_AES Decryption: %s\n", 0 == strncmp((char*) tmp3, (char*) plain3, 17) ? "SUCCESS!" : "FAILURE!");

	return 0;
}